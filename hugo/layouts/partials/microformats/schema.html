{{ $isPage := or (and (ne .Type "posts") (in "section page" .Kind )) (and (eq .Type "posts") (eq .Kind "page")) }}
{{- if eq .Kind "home" }}
  <script type="application/ld+json">
  {{- $schema := dict "@context" "http://schema.org" "@type" "WebSite" "name" .Site.Title "url" .Site.Home.Permalink "inLanguage" .Lang -}}
  {{- with partial "utils/description" . -}}
    {{- $schema = merge $schema (dict "description" (printf "%s" (. | plainify | htmlUnescape | chomp))) -}}
  {{- end -}}
  {{- with partial "utils/featured" . -}}
    {{- $schema = merge $schema (dict "thumbnailUrl" .) -}}
  {{- end -}}
  {{- with .Site.Params.geekdocContentLicense -}}
    {{- $schema = merge $schema (dict "license" .name) -}}
  {{- end -}}
  {{ $schema | jsonify }}
  </script>
{{- else if $isPage }}
  <script type="application/ld+json">
  {{- $title := partial "utils/title" . | string -}}
  {{- $schema := dict "@context" "http://schema.org" "@type" "TechArticle" "articleSection" (.Section | humanize | title) "name" $title "url" .Permalink "headline" $title "wordCount" .WordCount "inLanguage" .Lang "isFamilyFriendly" "true" "copyrightHolder" .Site.Title "copyrightYear" (.Date.Format "2006") "dateCreated" (.Date.Format "2006-01-02T15:04:05.00Z") "datePublished" (.PublishDate.Format "2006-01-02T15:04:05.00Z") "dateModified" (.Lastmod.Format "2006-01-02T15:04:05.00Z") -}}
  {{- with .Params.lead -}}
    {{- $schema = merge $schema (dict "alternativeHeadline" .) -}}
  {{- end -}}
  {{- with partial "utils/description" . -}}
    {{- $schema = merge $schema (dict "description" (printf "%s" (. | plainify | htmlUnescape | chomp))) -}}
  {{- end -}}
  {{- with partial "utils/featured" . -}}
    {{- $schema = merge $schema (dict "thumbnailUrl" .) -}}
  {{- end -}}
  {{- with .Site.Params.geekdocContentLicense -}}
    {{- $schema = merge $schema (dict "license" .name) -}}
  {{- end -}}
  {{- $schema = merge $schema (dict "mainEntityOfPage" (dict "@type" "WebPage" "@id" .Permalink)) -}}
  {{- with .Params.tags -}}
    {{- $schema = merge $schema (dict "keywords" .) -}}
  {{- end -}}
  {{- $logo := default "brand.svg" .Site.Params.geekdocLogo | absURL -}}
  {{- $schema = merge $schema (dict "publisher" (dict "@type" "Organization" "name" .Site.Title "url" .Site.Home.Permalink "logo" (dict "@type" "ImageObject" "url" $logo "width" "32" "height" "32"))) -}}
  {{ $schema | jsonify }}
  </script>
{{- end }}
